<section class="allLogin">
    <section class="allLogin-info">
        <section class="allLogin-info-cont">
            <header class="allLogin-info-cont-titulo">
                <div class="logoContainer">
                    <img src="/assets/logo/geturplan_logo.svg" alt="logo">
                    <h2>geturplan</h2>
                </div>
            </header>
            <div class="allLogin-info-cont-img">
                <img src="/assets/images/snowboarding.jpg" alt="Imagen de inicio">
            </div>
            <div class="allLogin-info-cont-text">
                <div class="allLogin-info-cont-text-titulo">
                    <h3>Bienvenido de nuevo</h3>
                </div>
                <div class="allLogin-info-cont-text-p">
                    <p>Descubre los nuevos planes de esta semana.</p>
                    <p>Conoce a gente nueva disfrutando de los mejores lugares.</p>
                </div>
            </div>
        </section>
    </section>
    
    @if (!resetPassword()) {
    <section class="allLogin-cont">
        <section class="login">
            <article class="login-titulo">
                <h3>Iniciar sesión</h3>
                <p>Accede a tu cuenta para explorar nuevos planes.</p>
            </article>
            
            <form [formGroup]="loginForm" (ngSubmit)="onSubmit(loginForm.value)" class="login-form">
                <div class="inputContainer">
                    <label for="email">Correo electrónico</label>
                    <div class="input">
                        <div class="input-icon">
                            <i class="fa-solid fa-envelope"></i>
                        </div>
                        <input 
                            type="email" 
                            id="email" 
                            placeholder="tu@email.com"
                            formControlName="email">
                    </div>
                    @if (submitted() && loginForm.controls['email'].invalid) {
                    <div class="errorMessage">
                        <i class="fa-solid fa-circle-exclamation"></i>
                        @if (loginForm.controls['email'].errors?.['required']) {
                        <span>El email es obligatorio</span>
                        }
                        @if (loginForm.controls['email'].errors?.['email']) {
                        <span>El email no es válido</span>
                        }
                    </div>
                    }
                </div>

                <div class="inputContainer">
                    <label for="password">Contraseña</label>
                    <div class="input">
                        <div class="input-icon">
                            <i class="fa-solid fa-lock"></i>
                        </div>
                        <input 
                            [type]="inputtype()" 
                            id="password" 
                            placeholder="••••••••"
                            formControlName="password">
                        <button type="button" class="toggle-password" (click)="showpassword()">
                            <i [class]="showPasswordImg() === '/assets/icons/eye.png' ? 'fa-solid fa-eye' : 'fa-solid fa-eye-slash'"></i>
                        </button>
                    </div>
                    @if (submitted() && loginForm.controls['password'].invalid) {
                    <div class="errorMessage">
                        <i class="fa-solid fa-circle-exclamation"></i>
                        @if (loginForm.controls['password'].errors?.['required']) {
                        <span>La contraseña es obligatoria</span>
                        }
                    </div>
                    }
                </div>

                @if(showErrorMessage()){
                <div class="errorMessage">
                    <i class="fa-solid fa-circle-exclamation"></i>
                    <span>{{message()}}</span>
                </div>
                }

                <div class="forgot-link">
                    <a rel="noopener noreferrer" (click)="resetPassword.set(!resetPassword())">
                        ¿Olvidaste tu contraseña?
                    </a>
                </div>

                <button type="submit" class="btn-submit">
                    Iniciar sesión
                </button>
            </form>

            <div class="register-link">
                <span>¿No tienes cuenta?</span>
                <a href="/register">Regístrate gratis</a>
            </div>

            <div class="back-link">
                <a rel="noopener noreferrer" href="/">
                    <i class="fa-solid fa-arrow-left"></i>
                    <span>Volver al inicio</span>
                </a>
            </div>
        </section>
    </section>
    } @else {
    <section class="allLogin-cont">
        <section class="login">
            <article class="login-titulo">
                <h3>Recuperar contraseña</h3>
                <p>Ingresa tu correo para recibir instrucciones.</p>
            </article>
            
            <form [formGroup]="resetPassForm" (ngSubmit)="sendEmail(resetPassForm.value)" class="login-form">
                <div class="inputContainer">
                    <label for="reset-email">Correo electrónico</label>
                    <div class="input">
                        <div class="input-icon">
                            <i class="fa-solid fa-envelope"></i>
                        </div>
                        <input 
                            type="email" 
                            id="reset-email" 
                            placeholder="tu@email.com"
                            formControlName="email">
                    </div>
                    @if (submitted() && resetPassForm.controls['email'].invalid) {
                    <div class="errorMessage">
                        <i class="fa-solid fa-circle-exclamation"></i>
                        @if (resetPassForm.controls['email'].errors?.['required']) {
                        <span>El email es obligatorio</span>
                        }
                        @if (resetPassForm.controls['email'].errors?.['email']) {
                        <span>El email no es válido</span>
                        }
                    </div>
                    }
                    @if(showErrorMessage()){
                    <div class="errorMessage">
                        <i class="fa-solid fa-circle-exclamation"></i>
                        <span>{{message()}}</span>
                    </div>
                    }
                </div>

                <button type="submit" class="btn-submit">
                    Enviar correo de recuperación
                </button>
            </form>

            <div class="back-link">
                <a rel="noopener noreferrer" (click)="resetPassword.set(!resetPassword())">
                    <i class="fa-solid fa-arrow-left"></i>
                    <span>Volver al login</span>
                </a>
            </div>
        </section>
    </section>
    }
</section>
<app-toast-notification />