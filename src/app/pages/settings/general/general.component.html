<div class="general-settings">
    <div class="section-header">
        <h3>Configuración general</h3>
        <p>Administra la información básica de tu cuenta</p>
    </div>

    <form class="settings-form" method="post" [formGroup]="editGeneral" (ngSubmit)="onSubmit(editGeneral.value)">
        <div class="form-group">
            <label for="username">Nombre de usuario</label>
            <input type="text" id="username" placeholder="Ej: juanperez" formControlName="username">
            <div class="input-info">
                <i class="fa-solid fa-link"></i>
                <span>URL: https://geturplanfrontend.vercel.app/perfil/<strong>{{user?.username}}</strong></span>
            </div>
            @if (submitted() && editGeneral.controls['username'].invalid) {
            <div class="errorMessage">
                <i class="fa-solid fa-circle-exclamation"></i>
                @if (editGeneral.controls['username'].errors?.['required']) {
                <span>El nombre de usuario es obligatorio</span>
                }
            </div>
            }
            @if (conflictUsername()) {
            <div class="errorMessage">
                <i class="fa-solid fa-circle-exclamation"></i>
                <span>El nombre de usuario ya está en uso</span>
            </div>
            }
        </div>

        <div class="form-group">
            <label for="email">Correo electrónico</label>
            <input type="email" id="email" placeholder="tu@email.com" formControlName="email">
            @if (submitted() && editGeneral.controls['email'].invalid) {
            <div class="errorMessage">
                <i class="fa-solid fa-circle-exclamation"></i>
                @if (editGeneral.controls['email'].errors?.['required']) {
                <span>El email es obligatorio</span>
                } @else if (editGeneral.controls['email'].errors?.['email']) {
                <span>El email no es válido</span>
                }
            </div>
            }
            @if (conflictEmail()) {
            <div class="errorMessage">
                <i class="fa-solid fa-circle-exclamation"></i>
                <span>El email ya está en uso</span>
            </div>
            }
        </div>

        <div class="form-actions">
            <button type="submit" class="btn-save">
                Guardar cambios
            </button>
        </div>
    </form>
</div>
<app-toast-notification />